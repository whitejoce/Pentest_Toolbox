#!/usr/bin/python
# _*_coding: utf-8 _*_
#Coder:Whitejoce

import requests
import bs4
from lxml import etree

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0'
    }


def get_html(url,headers):
    res = requests.get(url, headers=headers)
    #print(res.text)
    s=res.content
    s.decode('ISO-8859-1')
    bs = bs4.BeautifulSoup(s,"html.parser")
    html = bs.prettify()
    return html

if __name__ == '__main__':
    try:
        url="https://top.baidu.com/board?tab=realtime"
        html=get_html(url,headers=headers)
        #print(html)
        selector=etree.HTML(html)
        i=1
        news=""
        print("[+] 获取新闻(来自:" + url +"):" )
        for i in range(1,31):
            s=selector.xpath('//*[@id="sanRoot"]/main/div[2]/div/div[2]/div['+str(i)+']/div[2]/a/div[1]/text()')
            temp=s.pop().strip()
            print("    "+temp)
            news+=temp+"\n"
        
        print("\n[+] 获取新闻完成")
        with open('code/news.txt','w') as f:
            f.write(news)

    except Exception as Error:
        raise Error
